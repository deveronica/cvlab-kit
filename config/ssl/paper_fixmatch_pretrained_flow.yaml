# FixMatch with Pretrained Flow Generator
agent: flow_augmentation_fixmatch

# Pretrained flow model
flow_checkpoint: checkpoints/adaptive_augflow/latest.pt
flow_steps: 10

# Dataset
data_root: ./data/mstar
dataset:
  train: mstar(split="train")
  test: mstar(split="test")

# Transforms
size: 128
mean: [0.1414, 0.1414, 0.1414]
std: [0.1258, 0.1258, 0.1258]
padding: 16
padding_mode: reflect

transform:
  base: "resize | random_crop | random_flip | to_tensor | normalize"

# Data loaders
num_labeled: 100  # 10 per class for MSTAR (10 classes)
batch_size: 4
mu: 2  # unlabeled_batch = 4 * 2 = 8

dataloader:
  labeled: basic(shuffle=True, drop_last=True)
  unlabeled: basic(shuffle=True, drop_last=True)
  test: basic(shuffle=False, drop_last=False)

sampler:
  labeled: subset_random
  unlabeled: subset_random

# Models
model: wideresnet(depth=28, widen_factor=2, num_classes=10, dropout_rate=0.0)
generator: unet

# Optimizer
optimizer: adam
lr: 0.0003
weight_decay: 0.0005

# Loss
loss:
  cross_entropy: cross_entropy

# Metrics
metric:
  accuracy: accuracy

# Logger
logger: csv

# FixMatch parameters
threshold: 0.95
lambda_pl: 1.0      # Pseudo-labeling loss weight (Eq. 7)
lambda_cons: 0.5    # Consistency loss weight (Eq. 8)

# Adaptive augmentation difficulty range
min_difficulty: 0.0
max_difficulty: 1.0

# Training
epochs: 1
device: cpu

# Early stopping
early_stopping_patience: 100

# Random seed
seed: 42
n_gpu: 1

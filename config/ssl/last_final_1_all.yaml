# Last Final 1: Aug + Sampling + Threshold (All 3 Factors)
# Ablation: Full proposed method

run_name: "last_final_1_all"
agent: curriculum_adaptive_ssl
device: 0

epochs: 256
batch_size: 16
num_workers: 4
steps_per_epoch: 128

data_root: "./data/mstar"
size: 128
num_classes: 10
num_labeled: 100
mu: 7

lambda_u: 1.0
lambda_kl: 4.5
confidence_threshold: 0.95

pretrained: false
padding: 16
padding_mode: reflect
mean: !!python/tuple [0.1414, 0.1414, 0.1414]
std: !!python/tuple [0.1258, 0.1258, 0.1258]

lr: 0.003
weight_decay: 0

# Factor 1: Curriculum Sampling (20% -> 100% by 50% epoch)
curriculum:
  enabled: true
  weight_strategy: fisher
  start_ratio: 0.2
  saturation_epoch: 128
  schedule: linear

# Factor 2: Adaptive Augmentation
adaptive_augment:
  enabled: true
  scale_a: 10.0

# Factor 3: Dynamic Threshold (FlexMatch)
dynamic_threshold:
  enabled: true
  initial_threshold: 0.7
  warmup_epochs: 10
  flex_coefficient: 0.95

log_dir: "./logs/last_final"
logger: csv

model: resnet18
optimizer: adam

dataset:
  train: mstar(split="train")
  val: mstar(split="test")

dataloader:
  labeled: basic
  unlabeled: basic
  val: basic

sampler:
  labeled: subset_random
  unlabeled: subset_random

transform:
  weak: "resize | random_flip | random_crop | to_tensor | normalize"
  strong: "resize | random_flip | random_crop | adaptive_rand_augment(magnitude_min=0, magnitude_max=30) | to_tensor | normalize"
  val: "resize | to_tensor | normalize"

loss:
  supervised: cross_entropy(reduction="mean")
  unsupervised: cross_entropy(reduction="none")

metric:
  val: accuracy

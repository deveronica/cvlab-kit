# AugmentationFlow - Weak to Strong with Random Magnitude
# Learn: weak augmentation â†’ random strength augmentation

agent: augmentation_flow

data_root: "./data/mstar"
size: 128
mean: !!python/tuple [0.1414, 0.1414, 0.1414]
std: !!python/tuple [0.1258, 0.1258, 0.1258]
padding: 16
padding_mode: reflect

dataset: mstar(split="train")
dataloader: basic
batch_size: 4
num_workers: 0
epochs: 1

model: unet
optimizer: adam
lr: 0.0001

transform:
  weak: "resize | random_flip | random_crop | to_tensor | normalize"
  strong: "resize | random_flip | random_crop | rand_augment(m=5) | to_tensor | normalize"

predict: flow
max_grad_norm: 1.0

# Conditioning - disabled
use_conditioning: false

# EMA - enabled
use_ema: true
ema_kwargs:
  beta: 0.995
  update_every: 10

# === Checkpoint Directories ===
checkpoint_dir: checkpoints/augflow_random
results_dir: results/augflow_random

# Step-based saving
save_checkpoint_every: 50
save_results_every: 25

# Sampling
sample_steps: 10
num_samples: 4

device: 0

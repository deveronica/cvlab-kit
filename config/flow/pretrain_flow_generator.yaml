# AdaptiveAugmentationFlow - Original to Adaptive Strength
# Learn: no augmentation â†’ adaptive RandAugment (strength controlled by t)

agent: adaptive_augmentation_flow

data_root: "./data/mstar"
size: 128
mean: !!python/tuple [0.1414, 0.1414, 0.1414]
std: !!python/tuple [0.1258, 0.1258, 0.1258]
padding: 16
padding_mode: reflect

dataset: mstar(split="train")
dataloader: basic
batch_size: 4
num_workers: 0
epochs: 1

model: unet
optimizer: adam
lr: 0.0001

transform:
  base_pil: "resize | random_crop"
  base_tensor: "to_tensor | normalize"
  adaptive_augment:
    _type: adaptive_rand_augment
    magnitude_min: 0
    magnitude_max: 10
    num_ops: 2

predict: flow
max_grad_norm: 1.0

# Conditioning - disabled
use_conditioning: false

# EMA - enabled
use_ema: true
ema_kwargs:
  beta: 0.995
  update_every: 10

# === Checkpoint Directories ===
checkpoint_dir: checkpoints/adaptive_augflow
results_dir: results/adaptive_augflow

# Step-based saving
save_checkpoint_every: 50
save_results_every: 25

# Sampling
sample_steps: 10
num_samples: 4

device: 0
